<!doctype html>
<html lang="pl">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>WYSWIG</title>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        .container {
            display: flex;
            height: 90vh;
        }
        .left, .right {
            width: 50%;
            padding: 20px;
        }
        .left {
            border-right: 2px solid #000;
            display: flex;
            flex-direction: column;
        }
        textarea {
            width: 100%;
            flex-grow: 1;
        }
        .buttons {
            margin-bottom: 10px;
        }
        #preview {
            border: 1px solid #000;
            padding: 10px;
            height: 92%;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="left">
            <div class="buttons">
                <button type="button" id="pBtn" style="padding:4px" title="Akapit">
                    <?xml version="1.0" encoding="UTF-8"?><svg xmlns="http://www.w3.org/2000/svg" id="Layer_1" data-name="Layer 1" viewBox="0 0 24 24" width="15" height="15"><path d="M5,24H2V3.5C2,1.57,3.57,0,5.5,0H14c4.411,0,8,3.589,8,8s-3.589,8-8,8H5v8Zm0-11H14c2.757,0,5-2.243,5-5s-2.243-5-5-5H5.5c-.276,0-.5,.225-.5,.5V13Z"/></svg>
                </button>
                <button type="button" id="headerBtn" style="padding:4px" title="Nagłówek">
                    <?xml version="1.0" encoding="UTF-8"?><svg xmlns="http://www.w3.org/2000/svg" id="Layer_1" data-name="Layer 1" viewBox="0 0 24 24" width="15" height="15"><path d="M20.5,0c-.828,0-1.5,.671-1.5,1.5V10H5V1.5c-.033-1.972-2.967-1.971-3,0V22.5c.033,1.972,2.967,1.971,3,0V13h14v9.5c.034,1.972,2.967,1.971,3,0V1.5c0-.829-.672-1.5-1.5-1.5Z"/></svg>
                </button>
                <button type="button" id="boldBtn" style="padding:4px" title="Pogrubienie"><?xml version="1.0" encoding="UTF-8"?>
                    <svg xmlns="http://www.w3.org/2000/svg" id="Bold" viewBox="0 0 24 24" width="15" height="15"><path d="M17.954,10.663A6.986,6.986,0,0,0,12,0H5A2,2,0,0,0,3,2V22a2,2,0,0,0,2,2H15a6.994,6.994,0,0,0,2.954-13.337ZM7,4h5a3,3,0,0,1,0,6H7Zm8,16H7V14h8a3,3,0,0,1,0,6Z"/></svg>
                </button>
                <button type="button" id="linkBtn" style="padding:4px" title="link"><?xml version="1.0" encoding="UTF-8"?>
                    <svg xmlns="http://www.w3.org/2000/svg" id="Layer_1" data-name="Layer 1" viewBox="0 0 24 24" width="15" height="15"><path d="M7.896,16.104c-.586-.585-.586-1.536,0-2.121,.586-.586,1.535-.586,2.121,0,1.326,1.326,3.64,1.327,4.966,0l4.989-4.989c1.369-1.369,1.369-3.597,0-4.966s-3.597-1.369-4.966,0c-.586,.586-1.535,.586-2.121,0-.586-.585-.586-1.536,0-2.121,2.538-2.539,6.67-2.539,9.208,0,2.539,2.539,2.539,6.669,0,9.208l-4.989,4.989c-1.27,1.27-2.937,1.904-4.604,1.904s-3.335-.635-4.604-1.904Zm-1.384,7.893c1.667,0,3.334-.635,4.604-1.904,.586-.585,.586-1.536,0-2.121-.586-.586-1.535-.586-2.121,0-1.37,1.37-3.598,1.369-4.966,0-1.369-1.369-1.369-3.597,0-4.966l4.961-4.961c1.37-1.37,3.598-1.37,4.966,0,.586,.586,1.535,.586,2.121,0,.586-.585,.586-1.536,0-2.121-2.539-2.539-6.669-2.539-9.208,0L1.907,12.885c-2.539,2.539-2.539,6.669,0,9.208,1.27,1.27,2.937,1.904,4.604,1.904Z"/></svg>
                </button>
                <button type="button" id="link1Btn" style="padding:4px" title="Link z zaznaczeniem"><?xml version="1.0" encoding="UTF-8"?>
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 511.904 511.904" style="enable-background:new 0 0 511.904 511.904;" xml:space="preserve" width="15" height="15"><g><path d="M222.025,417.764c-33.872,35.124-89.034,38.364-126.784,7.445c-22.482-19.465-33.966-48.733-30.72-78.293   c2.811-21.794,12.997-41.97,28.864-57.173l61.355-61.397c12.492-12.496,12.492-32.752,0-45.248l0,0   c-12.496-12.492-32.752-12.492-45.248,0l-60.053,60.075C22.065,269.57,4.802,304.721,0.649,342.521   c-7.757,85.138,54.972,160.445,140.11,168.202c45.721,4.166,90.933-12.179,123.42-44.618l64.171-64.149   c12.492-12.496,12.492-32.752,0-45.248l0,0c-12.496-12.492-32.752-12.492-45.248,0L222.025,417.764z"/><path d="M451.358,31.289C387.651-15.517,299.186-8.179,244.062,48.484L183.667,108.9c-12.492,12.496-12.492,32.752,0,45.248l0,0   c12.496,12.492,32.752,12.492,45.248,0l61.355-61.291c33.132-34.267,86.738-38.127,124.437-8.96   c38.803,31.818,44.466,89.067,12.648,127.87c-1.862,2.271-3.833,4.45-5.907,6.53l-64.171,64.171   c-12.492,12.496-12.492,32.752,0,45.248l0,0c12.496,12.492,32.752,12.492,45.248,0l64.171-64.171   c60.413-60.606,60.257-158.711-0.349-219.124C461.638,39.727,456.631,35.341,451.358,31.289z"/><path d="M183.667,282.525l99.425-99.425c12.497-12.497,32.758-12.497,45.255,0l0,0c12.497,12.497,12.497,32.758,0,45.255   l-99.425,99.425c-12.497,12.497-32.758,12.497-45.255,0l0,0C171.17,315.283,171.17,295.022,183.667,282.525z"/></g></svg>
                </button>
                <button type="button" id="ulBtn" style="padding:4px" title="Lista punktowana">
                    <svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 24 24"><circle cx="4" cy="4" r="2"/><circle cx="4" cy="12" r="2"/><circle cx="4" cy="20" r="2"/><rect x="9" y="3" width="12" height="2"/><rect x="9" y="11" width="12" height="2"/><rect x="9" y="19" width="12" height="2"/></svg>
                </button>
                <button type="button" id="olBtn" style="padding:4px" title="Lista numerowana">
                    <svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 24 24"><text x="2" y="6" font-size="8" font-family="Arial" font-weight="bold">1.</text><text x="2" y="14" font-size="8" font-family="Arial" font-weight="bold">2.</text><text x="2" y="22" font-size="8" font-family="Arial" font-weight="bold">3.</text><rect x="9" y="3" width="12" height="2"/><rect x="9" y="11" width="12" height="2"/><rect x="9" y="19" width="12" height="2"/></svg>
                </button>
                <button type="button" id="colorBtn" style="padding:4px" title="Zielony z pogrubieniem">
                    <svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="15" height="15" x="0" y="0" viewBox="0 0 24 24" style="enable-background:new 0 0 512 512" xml:space="preserve" class=""><g><path d="m20.057 16.8.1.1a1.912 1.912 0 0 0 1.769.521 1.888 1.888 0 0 0 1.377-1.177 11.924 11.924 0 0 0 .777-4.544A12.155 12.155 0 0 0 12.5.007 12 12 0 0 0 .083 12a12.014 12.014 0 0 0 12 12c.338 0 .67-.022 1-.05a1 1 0 0 0 .916-1l-.032-3.588a3.567 3.567 0 0 1 6.09-2.562Zm-2.942-8.75a1.5 1.5 0 1 1-1.065 1.835 1.5 1.5 0 0 1 1.065-1.835Zm-9.23 8.9a1.5 1.5 0 1 1 1.065-1.835 1.5 1.5 0 0 1-1.065 1.835Zm0-6A1.5 1.5 0 1 1 8.95 9.115a1.5 1.5 0 0 1-1.065 1.835Zm5-3a1.5 1.5 0 1 1 1.065-1.835 1.5 1.5 0 0 1-1.065 1.835Z" fill="#008000" opacity="1" data-original="#000000" class=""></path></g></svg>
                </button>
            </div>
            <form id="htmlForm" style="flex-grow: 1; display: flex; flex-direction: column;">
                <textarea id="content"></textarea>
            </form>
        </div>
        <div class="right">
            <button type="button" id="saveBtn" style="padding:4px" title="pobierz">
                <?xml version="1.0" encoding="UTF-8"?><svg xmlns="http://www.w3.org/2000/svg" id="Outline" viewBox="0 0 24 24" width="15" height="15"><path d="M9.878,18.122a3,3,0,0,0,4.244,0l3.211-3.211A1,1,0,0,0,15.919,13.5l-2.926,2.927L13,1a1,1,0,0,0-1-1h0a1,1,0,0,0-1,1l-.009,15.408L8.081,13.5a1,1,0,0,0-1.414,1.415Z"/><path d="M23,16h0a1,1,0,0,0-1,1v4a1,1,0,0,1-1,1H3a1,1,0,0,1-1-1V17a1,1,0,0,0-1-1H1a1,1,0,0,0-1,1v4a3,3,0,0,0,3,3H21a3,3,0,0,0,3-3V17A1,1,0,0,0,23,16Z"/></svg>
            </button>
            <button type="button" id="copyBtn" style="padding:4px" title="kopiuj">
                <svg id="Layer_1" height="15" viewBox="0 0 24 24" width="15" xmlns="http://www.w3.org/2000/svg" data-name="Layer 1"><path d="m13 20a5.006 5.006 0 0 0 5-5v-8.757a3.972 3.972 0 0 0 -1.172-2.829l-2.242-2.242a3.972 3.972 0 0 0 -2.829-1.172h-4.757a5.006 5.006 0 0 0 -5 5v10a5.006 5.006 0 0 0 5 5zm-9-5v-10a3 3 0 0 1 3-3s4.919.014 5 .024v1.976a2 2 0 0 0 2 2h1.976c.01.081.024 9 .024 9a3 3 0 0 1 -3 3h-6a3 3 0 0 1 -3-3zm18-7v11a5.006 5.006 0 0 1 -5 5h-9a1 1 0 0 1 0-2h9a3 3 0 0 0 3-3v-11a1 1 0 0 1 2 0z"/></svg>
            </button>
            <div id="preview" style="margin-top:10px"></div>
        </div>
    </div>
    <hr>
    <p style="font-size:12px; font-family:verdana">simplySMART</p>

   <script>
        $(document).ready(function() {
            function autoLink(text) {
                var urlPattern = /(https?:\/\/[^\s<]+)/g;
                return text.replace(urlPattern, '<a href="$1" target="_blank">$1</a>');
            }

            $('#content').on('input', function() {
                var content = $(this).val();
                content = autoLink(content).replace(/\n(?!.*<a)/g, '<br>');
                $('#preview').html(`<span style="font-family:Verdana"><span style="font-size:12pt"><span style="color:#444444">` + content + `</span></span></span>`);
            });

                function stripHtmlTags(html) {
                    var div = document.createElement("div");
                    div.innerHTML = html;
                    return div.innerText || div.textContent;
                }

                $('#pBtn').click(function() {
                    var textarea = $('#content')[0];
                    var start = textarea.selectionStart;
                    var end = textarea.selectionEnd;
                    if (start !== end) {
                        var text = $('#content').val();
                        var before = text.substring(0, start);
                        var selected = text.substring(start, end);
                        var after = text.substring(end);

                        var cleanText = stripHtmlTags(selected);
                        var styledText = `<span style="font-size:12pt; font-family:Verdana; color:#444444;">${cleanText}</span>`;

                        $('#content').val(before + styledText + after);
                        $('#content').trigger('input');
                    }
                });

                $('#headerBtn').click(function() {
                    var textarea = $('#content')[0];
                    var start = textarea.selectionStart;
                    var end = textarea.selectionEnd;
                    if (start !== end) {
                        var text = $('#content').val();
                        var before = text.substring(0, start);
                        var selected = text.substring(start, end);
                        var after = text.substring(end);

                        var cleanText = stripHtmlTags(selected);
                        var styledText = `<span style="font-size:14pt; font-family:Verdana; color:#444444; font-weight:bold;">${cleanText}</span>`;

                        $('#content').val(before + styledText + after);
                        $('#content').trigger('input');
                    }
                });




            $('#boldBtn').click(function() {
                var textarea = $('#content')[0];
                var start = textarea.selectionStart;
                var end = textarea.selectionEnd;
                if (start !== end) {
                    var text = $('#content').val();
                    var before = text.substring(0, start);
                    var selected = text.substring(start, end);
                    var after = text.substring(end);
                    $('#content').val(before + '<b>' + selected + '</b>' + after);
                    $('#content').trigger('input');
                }
            });

            $('#linkBtn').click(function() {
                var textarea = $('#content')[0];
                var start = textarea.selectionStart;
                var end = textarea.selectionEnd;
                if (start !== end) {
                    var url = prompt("Podaj adres URL:");
                    if (url) {
                        var text = $('#content').val();
                        var before = text.substring(0, start);
                        var selected = text.substring(start, end);
                        var after = text.substring(end);
                        $('#content').val(before + '<a href="' + url + '" target="_blank">' + selected + '</a>' + after);
                        $('#content').trigger('input');
                    }
                }
            });

            $('#link1Btn').click(function() {
                var textarea = $('#content')[0];
                var start = textarea.selectionStart;
                var end = textarea.selectionEnd;
                if (start !== end) {
                    var text = $('#content').val();
                    var before = text.substring(0, start);
                    var selected = text.substring(start, end);
                    var after = text.substring(end);
                    $('#content').val(before + '<a href="' + selected + '" target="_blank">' + selected + '</a>' + after);
                    $('#content').trigger('input');
                }
            });

            $('#colorBtn').click(function() {
                var textarea = $('#content')[0];
                var start = textarea.selectionStart;
                var end = textarea.selectionEnd;
                if (start !== end) {
                    var text = $('#content').val();
                    var before = text.substring(0, start);
                    var selected = text.substring(start, end);
                    var after = text.substring(end);
                    $('#content').val(before + '<b><span style="color:#008000;">' + selected + '</span></b>' + after);
                    $('#content').trigger('input');
                }
            });

            $('#ulBtn').click(function() {
                var textarea = $('#content')[0];
                var start = textarea.selectionStart;
                var end = textarea.selectionEnd;
                if (start !== end) {
                    var text = $('#content').val();
                    var before = text.substring(0, start);
                    var selected = text.substring(start, end);
                    var after = text.substring(end);

                    // Zamiana każdej nowej linii na element listy `<li>`
                    var listItems = selected.split('\n').map(item => `<li>${item}</li>`).join('');
                    var listHtml = `<ul>${listItems}</ul>`;

                    $('#content').val(before + listHtml + after);
                    $('#content').trigger('input');
                }
            });

            $('#olBtn').click(function() {
                var textarea = $('#content')[0];
                var start = textarea.selectionStart;
                var end = textarea.selectionEnd;
                if (start !== end) {
                    var text = $('#content').val();
                    var before = text.substring(0, start);
                    var selected = text.substring(start, end);
                    var after = text.substring(end);

                    // Zamiana każdej nowej linii na element listy `<li>` w numerowanej `<ol>`
                    var listItems = selected.split('\n').map(item => `<li>${item}</li>`).join('');
                    var listHtml = `<ol>${listItems}</ol>`;

                    $('#content').val(before + listHtml + after);
                    $('#content').trigger('input');
                }
            });


            $('#copyBtn').click(function() {
                var content = `<html><head><meta charset='UTF-8'></head><body>` + $('#preview').html() + `</body></html>`;
                var tempElement = document.createElement('textarea');
                tempElement.value = content;
                document.body.appendChild(tempElement);
                tempElement.select();
                document.execCommand('copy');
                document.body.removeChild(tempElement);
                alert('Podgląd został skopiowany do schowka!');
            });

            $('#saveBtn').click(function() {
                var content = `<html><head><meta charset='UTF-8'></head><body>` + $('#preview').html() + `</body></html>`;
                var blob = new Blob([content], { type: 'text/html' });
                var a = document.createElement('a');
                a.href = URL.createObjectURL(blob);
                a.download = 'nowy_plik.html';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            });

        });
    </script>
</body>
</html>
